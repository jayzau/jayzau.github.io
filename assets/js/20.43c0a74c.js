(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{374:function(s,a,t){"use strict";t.r(a);var n=t(42),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("blockquote",[t("p",[s._v("Read：允许用户读取指定数据库")]),s._v(" "),t("p",[s._v("readWrite：允许用户读写指定数据库")]),s._v(" "),t("p",[s._v("dbAdmin：允许用户在指定数据库中执行管理函数，如索引创建、删除，查看统计或访问system.profile")]),s._v(" "),t("p",[s._v("userAdmin：允许用户向system.users集合写入，可以找指定数据库里创建、删除和管理用户")]),s._v(" "),t("p",[s._v("clusterAdmin：只在admin数据库中可用，赋予用户所有分片和复制集相关函数的管理权限。")]),s._v(" "),t("p",[s._v("readAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的读权限")]),s._v(" "),t("p",[s._v("readWriteAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的读写权限")]),s._v(" "),t("p",[s._v("userAdminAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的userAdmin权限")]),s._v(" "),t("p",[s._v("dbAdminAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的dbAdmin权限。")]),s._v(" "),t("p",[s._v("root：只在admin数据库中可用。超级账号，超级权限。")])]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("登入mongo，默认本地27017端口，管理员登入不需要加"),t("code",[s._v("authenticationDatabase")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mongo "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pwd"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--port")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27017")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--host")]),s._v(" localhost "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--authenticationDatabase")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database"')]),s._v("\n")])])]),t("p",[s._v("选择"),t("code",[s._v("db")]),s._v("，没有"),t("code",[s._v("db")]),s._v("会新建，新建的"),t("code",[s._v("db")]),s._v("没有"),t("code",[s._v("collection")]),s._v("不会显示。然后创建用户，给权限。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use database\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.createUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("user:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jayzau"')]),s._v(",pwd:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(",roles:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("role:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dbAdmin"')]),s._v(",db:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nSuccessfully added user: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jayzau"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"roles"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"role"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dbAdmin"')]),s._v(",\n                        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database"')]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.auth"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("“jayzau”,”123456”"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("..."),t("code",[s._v("dbAdmin")]),s._v("并不包括读写权限，所以需要修改。"),t("code",[s._v(".getUser")]),s._v("方法可以查看角色信息。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database.jayzau"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userId"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" UUID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2ee43f49-a793-4d59-88e8-cb012c29d4e4"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jayzau"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"roles"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"role"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dbAdmin"')]),s._v(",\n                        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database"')]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mechanisms"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SCRAM-SHA-1"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SCRAM-SHA-256"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[t("code",[s._v("mechanisms")]),s._v("是验证方式，和版本有关。3.0版本之前貌似是"),t("code",[s._v("MONGODB-CR")]),s._v("。"),t("code",[s._v("mongo --help")]),s._v("能看见"),t("code",[s._v("--authenticationMechanism")]),s._v("参数。写错了也连不上。")]),s._v(" "),t("p",[t("code",[s._v(".updateUser")]),s._v("方法里的"),t("code",[s._v("roles")]),s._v("参数是覆盖，而不是"),t("code",[s._v("update")]),s._v("。所以权限得写全。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.updateUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jayzau"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("roles:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("role:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"readWrite"')]),s._v(", db:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("role:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dbAdmin"')]),s._v(",db:"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("这样就用"),t("code",[s._v("jayzau")]),s._v("用户在"),t("code",[s._v("database")]),s._v("里面随意造作了！")])])}),[],!1,null,null,null);a.default=e.exports}}]);