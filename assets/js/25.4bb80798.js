(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{383:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h3",{attrs:{id:"基本方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本方法"}},[t._v("#")]),t._v(" 基本方法")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("方法1")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开始执行"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" root@101.200.120.188 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'echo "创建文件test"; mkdir test; echo "创建完毕，准备退出"; exit\'')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"执行完毕"')]),t._v("\n")])])]),a("p",[a("code",[t._v("ssh")]),t._v("登陆后，服务器内进行的操作要写到单引号内（"),a("code",[t._v("''")]),t._v("），不然会进入服务器终端操作界面。")]),t._v(" "),a("p",[t._v("网上博客都说引号内指令不能换行，但是写一行太不美观，可读性也差。实践了一下，换行操作是可行的。")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开始执行"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" root@101.200.120.188 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'\necho "创建文件test"; \nmkdir test; \necho "创建完毕，准备退出"; \nexit\'')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"执行完毕"')]),t._v("\n")])])]),a("p",[t._v("两者执行效果相同。")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("方法2")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开始执行"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" root@101.200.120.188 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('EOF\n\necho "创建文件test"\nmkdir test\necho "创建完毕，准备退出"\nexit\n\nEOF')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"执行完毕"')]),t._v("\n")])])]),a("p",[t._v("利用"),a("code",[t._v("EOF")]),t._v("，看起来美观多了，实际效果也还不错。不过在"),a("code",[t._v("ssh")]),t._v("连接之后会打印一条本不是我们主动打印的信息：")]),t._v(" "),a("p",[a("code",[t._v("Pseudo-terminal will not be allocated because stdin is not a terminal. 因为stdin不是终端，所以不会分配伪终端。")])]),t._v(" "),a("p",[t._v("解决方案，增加-t -t参数来强制伪终端分配，即使标准输入不是终端。")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开始执行"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" root@101.200.120.188 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("EOF\nmkdir test\nexit\nEOF")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"执行完毕"')]),t._v("\n")])])]),a("p",[t._v("这样做还有一个好处，就是执行的命令以及响应的结果都会打印出来，就相当于在本机手动一条一条输入执行命令一样，更方便排查错误。")])])]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[t._v("#")]),t._v(" 实例")]),t._v(" "),a("p",[t._v("实现自动拉取代码仓库代码。")]),t._v(" "),a("h5",{attrs:{id:"脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#脚本"}},[t._v("#")]),t._v(" 脚本：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" root@101.200.120.188 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('EOF\ncd PythonProjects\n[ -d ./architect-awesome ] && echo "Found folder." || git clone git@github.com:jayzau/architect-awesome.git\ncd architect-awesome\ngit pull\nexit\nEOF')]),t._v("\n")])])]),a("h5",{attrs:{id:"连续运行两次"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#连续运行两次"}},[t._v("#")]),t._v(" 连续运行两次：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" jayzau@jayzau-PC:~/Documents$ ./demo.sh \nLast login: Wed Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":25:11 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),t._v(" from "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("106.87")]),t._v(".5.134\n\nWelcome to Alibaba Cloud Elastic Compute Service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" PythonProjects\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" ./architect-awesome "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Found folder."')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone git@github.com:jayzau/architect-awesome.git\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" architect-awesome\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" pull\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@jayzau ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd PythonProjects")]),t._v("\nolder."),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" || git clone git@github.com:jayzau/architect-awesome.git&& echo "')]),t._v("Found f \n正克隆到 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'architect-awesome'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nremote: Enumerating objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("789")]),t._v(", done.\nremote: Total "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("789")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", reused "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", pack-reused "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("789")]),t._v("\n接收对象中: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("789")]),t._v("/789"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.17")]),t._v(" MiB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("34.00")]),t._v(" KiB/s, done.\n处理 delta 中: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("253")]),t._v("/253"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", done.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@jayzau PythonProjects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd architect-awesome")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@jayzau architect-awesome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git pull")]),t._v("\nAlready up-to-date.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@jayzau architect-awesome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# exit")]),t._v("\n登出\nConnection to "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("101.200")]),t._v(".120.188 closed.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" jayzau@jayzau-PC:~/Documents$ ./demo.sh \nLast login: Wed Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(":25:53 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),t._v(" from "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("106.87")]),t._v(".5.134\n\nWelcome to Alibaba Cloud Elastic Compute Service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" PythonProjects\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" ./architect-awesome "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Found folder."')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone git@github.com:jayzau/architect-awesome.git\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" architect-awesome\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" pull\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@jayzau ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd PythonProjects")]),t._v("\nolder."),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" || git clone git@github.com:jayzau/architect-awesome.git&& echo "')]),t._v("Found f \nFound folder.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@jayzau PythonProjects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd architect-awesome")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@jayzau architect-awesome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git pull")]),t._v("\nAlready up-to-date.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@jayzau architect-awesome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# exit")]),t._v("\n登出\nConnection to "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("101.200")]),t._v(".120.188 closed.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" jayzau@jayzau-PC:~/Documents$ \n")])])]),a("p",[t._v("可以看出程序是正常执行了，但是"),a("code",[t._v('older." || git clone git@github.com:jayzau/architect-awesome.git&& echo "Found f')]),t._v("这一部分还是让人很不爽。于是我又试了试第一种写法，运行结果如下：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" jayzau@jayzau-PC:~/Documents$ ./demo2.sh \n开始执行\n正克隆到 "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'architect-awesome'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nAlready up-to-date.\n执行完毕\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" jayzau@jayzau-PC:~/Documents$ ./demo2.sh \n开始执行\nFound folder.\nAlready up-to-date.\n执行完毕\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" jayzau@jayzau-PC:~/Documents$ \n")])])]),a("p",[t._v("Awesome！打印界面瞬间清爽了好多！由于没有终端，所以克隆项目的时候无法看到进度，这可能算是一个扣分项，但是只要代码逻辑理清楚了，保证程序不出错的情况下，还是更喜欢清爽的写法1。")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("什么是EOF：")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("EOF")]),t._v("是一个计算机术语，为"),a("strong",[t._v("End Of File")]),t._v("的缩写，在操作系统中表示资料源无更多的资料可读取。 资料源通常称为档案或串流。 通常在文本的最后存在此字符表示资料结束。    ——百度百科")])]),t._v(" "),a("p",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2011/11/eof.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("EOF是什么？ - 阮一峰的网络日志"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/zongshi1992/article/details/71693045",target:"_blank",rel:"noopener noreferrer"}},[t._v("linux shell脚本EOF妙用- zongshi1992的博客- CSDN博客"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);